/*! dominode-filestream - v0.0.3 - 2012-07-02
* https://github.com/sam/dominode-filestream
*/
(function(){var a=function(b,c){var d=a.resolve(b,c||"/"),e=a.modules[d];if(!e)throw new Error("Failed to resolve module "+b+", tried "+d);var f=a.cache[d],g=f?f.exports:e();return g};a.paths=[],a.modules={},a.cache={},a.extensions=[".js",".coffee"],a._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},a.resolve=function(){return function(b,c){function h(b){b=d.normalize(b);if(a.modules[b])return b;for(var c=0;c<a.extensions.length;c++){var e=a.extensions[c];if(a.modules[b+e])return b+e}}function i(b){b=b.replace(/\/+$/,"");var c=d.normalize(b+"/package.json");if(a.modules[c]){var e=a.modules[c](),f=e.browserify;if(typeof f=="object"&&f.main){var g=h(d.resolve(b,f.main));if(g)return g}else if(typeof f=="string"){var g=h(d.resolve(b,f));if(g)return g}else if(e.main){var g=h(d.resolve(b,e.main));if(g)return g}}return h(b+"/index")}function j(a,b){var c=k(b);for(var d=0;d<c.length;d++){var e=c[d],f=h(e+"/"+a);if(f)return f;var g=i(e+"/"+a);if(g)return g}var f=h(a);if(f)return f}function k(a){var b;a==="/"?b=[""]:b=d.normalize(a).split("/");var c=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";c.push(f)}return c}c||(c="/");if(a._core[b])return b;var d=a.modules.path();c=d.resolve("/",c);var e=c||"/";if(b.match(/^(?:\.\.?\/|\/)/)){var f=h(d.resolve(e,b))||i(d.resolve(e,b));if(f)return f}var g=j(b,e);if(g)return g;throw new Error("Cannot find module '"+b+"'")}}(),a.alias=function(b,c){var d=a.modules.path(),e=null;try{e=a.resolve(b+"/package.json","/")}catch(f){e=a.resolve(b,"/")}var g=d.dirname(e),h=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(a.modules);for(var i=0;i<h.length;i++){var j=h[i];if(j.slice(0,g.length+1)===g+"/"){var k=j.slice(g.length);a.modules[c+k]=a.modules[g+k]}else j===g&&(a.modules[c]=a.modules[g])}},function(){var b={};a.define=function(c,d){a.modules.__browserify_process&&(b=a.modules.__browserify_process());var e=a._core[c]?"":a.modules.path().dirname(c),f=function(b){return a(b,e)};f.resolve=function(b){return a.resolve(b,e)},f.modules=a.modules,f.define=a.define,f.cache=a.cache;var g={exports:{}};a.modules[c]=function(){return a.cache[c]=g,d.call(g.exports,f,g,g.exports,e,c,b),g.exports}}}(),a.define("path",function(a,b,c,d,e,f){function g(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function h(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var i=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:f.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=h(g(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=h(g(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(g(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=i.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=i.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return i.exec(a)[3]||""}}),a.define("__browserify_process",function(a,b,c,d,e,f){var f=b.exports={};f.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}(),f.title="browser",f.browser=!0,f.env={},f.argv=[],f.binding=function(b){if(b==="evals")return a("vm");throw new Error("No such module. (Possibly not yet loaded)")},function(){var b="/",c;f.cwd=function(){return b},f.chdir=function(d){c||(c=a("path")),b=c.resolve(d,b)}}()}),a.define("stream",function(a,b,c,d,e,f){function i(){g.EventEmitter.call(this)}var g=a("events"),h=a("util");h.inherits(i,g.EventEmitter),b.exports=i,i.Stream=i,i.prototype.pipe=function(a,b){function d(b){a.writable&&!1===a.write(b)&&c.pause&&c.pause()}function e(){c.readable&&c.resume&&c.resume()}function g(){if(f)return;f=!0,a._pipeCount--,j();if(a._pipeCount>0)return;a.end()}function h(){if(f)return;f=!0,a._pipeCount--,j();if(a._pipeCount>0)return;a.destroy()}function i(a){j();if(this.listeners("error").length===0)throw a}function j(){c.removeListener("data",d),a.removeListener("drain",e),c.removeListener("end",g),c.removeListener("close",h),c.removeListener("error",i),a.removeListener("error",i),c.removeListener("end",j),c.removeListener("close",j),a.removeListener("end",j),a.removeListener("close",j)}var c=this;c.on("data",d),a.on("drain",e),!a._isStdio&&(!b||b.end!==!1)&&(a._pipeCount=a._pipeCount||0,a._pipeCount++,c.on("end",g),c.on("close",h));var f=!1;return c.on("error",i),a.on("error",i),c.on("end",j),c.on("close",j),a.on("end",j),a.on("close",j),a.emit("pipe",c),a}}),a.define("events",function(a,b,c,d,e,f){f.EventEmitter||(f.EventEmitter=function(){});var g=c.EventEmitter=f.EventEmitter,h=typeof Array.isArray=="function"?Array.isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},i=10;g.prototype.setMaxListeners=function(a){this._events||(this._events={}),this._events.maxListeners=a},g.prototype.emit=function(a){if(a==="error")if(!this._events||!this._events.error||h(this._events.error)&&!this._events.error.length)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if(typeof b=="function"){switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:var c=Array.prototype.slice.call(arguments,1);b.apply(this,c)}return!0}if(h(b)){var c=Array.prototype.slice.call(arguments,1),d=b.slice();for(var e=0,f=d.length;e<f;e++)d[e].apply(this,c);return!0}return!1},g.prototype.addListener=function(a,b){if("function"!=typeof b)throw new Error("addListener only takes instances of Function");this._events||(this._events={}),this.emit("newListener",a,b);if(!this._events[a])this._events[a]=b;else if(h(this._events[a])){if(!this._events[a].warned){var c;this._events.maxListeners!==undefined?c=this._events.maxListeners:c=i,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}this._events[a].push(b)}else this._events[a]=[this._events[a],b];return this},g.prototype.on=g.prototype.addListener,g.prototype.once=function(a,b){var c=this;return c.on(a,function d(){c.removeListener(a,d),b.apply(this,arguments)}),this},g.prototype.removeListener=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var c=this._events[a];if(h(c)){var d=c.indexOf(b);if(d<0)return this;c.splice(d,1),c.length==0&&delete this._events[a]}else this._events[a]===b&&delete this._events[a];return this},g.prototype.removeAllListeners=function(a){return a&&this._events&&this._events[a]&&(this._events[a]=null),this},g.prototype.listeners=function(a){return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),h(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]}}),a.define("util",function(a,b,c,d,e,f){function h(a){return a instanceof Array||Array.isArray(a)||a&&a!==Object.prototype&&h(a.__proto__)}function i(a){return a instanceof RegExp||typeof a=="object"&&Object.prototype.toString.call(a)==="[object RegExp]"}function j(a){if(a instanceof Date)return!0;if(typeof a!="object")return!1;var b=Date.prototype&&o(Date.prototype),c=a.__proto__&&o(a.__proto__);return JSON.stringify(c)===JSON.stringify(b)}function k(a){return a<10?"0"+a.toString(10):a.toString(10)}function m(){var a=new Date,b=[k(a.getHours()),k(a.getMinutes()),k(a.getSeconds())].join(":");return[a.getDate(),l[a.getMonth()],b].join(" ")}var g=a("events");c.print=function(){},c.puts=function(){},c.debug=function(){},c.inspect=function(a,b,d,e){function k(a,d){if(a&&typeof a.inspect=="function"&&a!==c&&(!a.constructor||a.constructor.prototype!==a))return a.inspect(d);switch(typeof a){case"undefined":return g("undefined","undefined");case"string":var e="'"+JSON.stringify(a).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return g(e,"string");case"number":return g(""+a,"number");case"boolean":return g(""+a,"boolean")}if(a===null)return g("null","null");var l=n(a),m=b?o(a):l;if(typeof a=="function"&&m.length===0){if(i(a))return g(""+a,"regexp");var p=a.name?": "+a.name:"";return g("[Function"+p+"]","special")}if(j(a)&&m.length===0)return g(a.toUTCString(),"date");var q,r,s;h(a)?(r="Array",s=["[","]"]):(r="Object",s=["{","}"]);if(typeof a=="function"){var t=a.name?": "+a.name:"";q=i(a)?" "+a:" [Function"+t+"]"}else q="";j(a)&&(q=" "+a.toUTCString());if(m.length===0)return s[0]+q+s[1];if(d<0)return i(a)?g(""+a,"regexp"):g("[Object]","special");f.push(a);var u=m.map(function(b){var c,e;a.__lookupGetter__&&(a.__lookupGetter__(b)?a.__lookupSetter__(b)?e=g("[Getter/Setter]","special"):e=g("[Getter]","special"):a.__lookupSetter__(b)&&(e=g("[Setter]","special"))),l.indexOf(b)<0&&(c="["+b+"]"),e||(f.indexOf(a[b])<0?(d===null?e=k(a[b]):e=k(a[b],d-1),e.indexOf("\n")>-1&&(h(a)?e=e.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):e="\n"+e.split("\n").map(function(a){return"   "+a}).join("\n"))):e=g("[Circular]","special"));if(typeof c=="undefined"){if(r==="Array"&&b.match(/^\d+$/))return e;c=JSON.stringify(""+b),c.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(c=c.substr(1,c.length-2),c=g(c,"name")):(c=c.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),c=g(c,"string"))}return c+": "+e});f.pop();var v=0,w=u.reduce(function(a,b){return v++,b.indexOf("\n")>=0&&v++,a+b.length+1},0);return w>50?u=s[0]+(q===""?"":q+"\n ")+" "+u.join(",\n  ")+" "+s[1]:u=s[0]+q+" "+u.join(", ")+" "+s[1],u}var f=[],g=function(a,b){var c={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},d={special:"cyan",number:"blue","boolean":"yellow","undefined":"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[b];return d?"["+c[d][0]+"m"+a+"["+c[d][1]+"m":a};return e||(g=function(a,b){return a}),k(a,typeof d=="undefined"?2:d)};var l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(a){},c.pump=null;var n=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},o=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.hasOwnProperty.call(a,c)&&b.push(c);return b},p=Object.create||function(a,b){var c;if(a===null)c={__proto__:null};else{if(typeof a!="object")throw new TypeError("typeof prototype["+typeof a+"] != 'object'");var d=function(){};d.prototype=a,c=new d,c.__proto__=a}return typeof b!="undefined"&&Object.defineProperties&&Object.defineProperties(c,b),c};c.inherits=function(a,b){a.super_=b,a.prototype=p(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}}),function(){function d(a,c){var d=this;b.Stream.call(d),d.readable=!0,d.type=c,d.encodings={binary:"readAsBinaryString",buffer:"readAsArrayBuffer",url:"readAsDataURL",dataUrl:"readAsDataURL",dataURL:"readAsDataURL",string:"readAsText",text:"readAsText"};if(a instanceof FileList)for(var e=0;e<a.length;e++)d.read(a[e]);else a&&d.read(a)}function e(){var a=this;b.Stream.call(a),a.writable=!0,a.readable=!0,this.loaded=0}function f(a){return new d(a)}var b=a("stream"),c=a("util");c.inherits(d,b.Stream),d.prototype.read=function(a){var b=this.type||"string",c=this.encodings[b],d=!1;c===undefined&&(d="`"+b+"` is not a valid encoding."),a instanceof File||a instanceof Blob||(d="You must provide a valid File object");if(d)throw new Error(d);var e=new FileReader,f=this.data.bind(this),g=this.error.bind(this);return e.onprogress=f,e.onload=f,e.onloadstart=f,e.onerror=g,e.onabort=g,e.onloadend=this.end.bind(this),e[c](a)},d.prototype.error=function(a){this.emit("error",a)},d.prototype.data=function(a){this.emit("data",a)},d.prototype.end=function(a){this.emit("data",a),this.emit("end",a)},c.inherits(e,b.Stream),e.prototype.write=function(a){return a.loaded===this.loaded?!0:(this.emit("data",a.target.result.slice(this.loaded)),this.loaded=a.loaded,!0)},e.prototype.end=function(){return this.emit("end"),!0},f.FileStream=d,f.FSStream=e,typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=f),exports=f):window.FileStream=f}()})();